RewriteEngine On 
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule (([0-9]+)x([0-9]+)_(.+)) adapt.php?file=$4&w=$2&h=$3&original=$1 [QSA]